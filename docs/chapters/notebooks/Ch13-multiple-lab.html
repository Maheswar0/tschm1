

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 13 &#8212; Introduction to Statistical Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/chapters/notebooks/Ch13-multiple-lab';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Chapter 2" href="Ch2-statlearn-lab.html" />
    <link rel="prev" title="Chapter 12" href="Ch12-unsup-lab.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.jpeg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/logo.jpeg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Introduction to Statistical Learning
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Introduction to Statistical Learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Ch10-deeplearning-lab.html">Chapter 10</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch11-surv-lab.html">Chapter 11</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch12-unsup-lab.html">Chapter 12</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">Chapter 13</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch2-statlearn-lab.html">Chapter 2</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch3-linreg-lab.html">Chapter 3</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch5-resample-lab.html">Chapter 5</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch6-varselect-lab.html">Chapter 6</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch7-nonlin-lab.html">Chapter 7</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch8-baggboost-lab.html">Chapter 8</a></li>

<li class="toctree-l2"><a class="reference internal" href="Ch9-svm-lab.html">Chapter 9</a></li>

</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/tschm/isl/master?urlpath=tree/book/docs/chapters/notebooks/Ch13-multiple-lab.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tschm/isl" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tschm/isl/edit/master/book/docs/chapters/notebooks/Ch13-multiple-lab.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tschm/isl/issues/new?title=Issue%20on%20page%20%2Fdocs/chapters/notebooks/Ch13-multiple-lab.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/docs/chapters/notebooks/Ch13-multiple-lab.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 13</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Chapter 13</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-multiple-testing">Lab: Multiple Testing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-hypothesis-tests">Review of Hypothesis Tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#family-wise-error-rate">Family-Wise Error Rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#false-discovery-rate">False Discovery Rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-re-sampling-approach">A Re-Sampling Approach</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-13">
<h1>Chapter 13<a class="headerlink" href="#chapter-13" title="Permalink to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="lab-multiple-testing">
<h1>Lab: Multiple Testing<a class="headerlink" href="#lab-multiple-testing" title="Permalink to this heading">#</a></h1>
<p>We include our usual imports seen in earlier labs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">ISLP</span> <span class="kn">import</span> <span class="n">load_data</span>
</pre></div>
</div>
</div>
</div>
<p>We also collect the new imports
needed for this lab.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> \
    <span class="p">(</span><span class="n">ttest_1samp</span><span class="p">,</span>
     <span class="n">ttest_rel</span><span class="p">,</span>
     <span class="n">ttest_ind</span><span class="p">,</span>
     <span class="n">t</span> <span class="k">as</span> <span class="n">t_dbn</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.multicomp</span> <span class="kn">import</span> \
     <span class="n">pairwise_tukeyhsd</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.multitest</span> <span class="kn">import</span> \
     <span class="n">multipletests</span> <span class="k">as</span> <span class="n">mult_test</span>
</pre></div>
</div>
</div>
</div>
<section id="review-of-hypothesis-tests">
<h2>Review of Hypothesis Tests<a class="headerlink" href="#review-of-hypothesis-tests" title="Permalink to this heading">#</a></h2>
<p>We begin by performing some one-sample <span class="math notranslate nohighlight">\(t\)</span>-tests.</p>
<p>First we create 100 variables, each consisting of 10 observations. The
first 50 variables have mean <span class="math notranslate nohighlight">\(0.5\)</span> and variance <span class="math notranslate nohighlight">\(1\)</span>, while the others
have mean <span class="math notranslate nohighlight">\(0\)</span> and variance <span class="math notranslate nohighlight">\(1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">true_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="n">X</span> <span class="o">+=</span> <span class="n">true_mean</span><span class="p">[</span><span class="kc">None</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<p>To begin, we use <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code>  from the
<code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> module to test <span class="math notranslate nohighlight">\(H_{0}: \mu_1=0\)</span>, the null
hypothesis that the first variable has mean zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9307442156164141
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-value comes out to 0.931, which is not low enough to
reject the null hypothesis at level <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>.  In this case,
<span class="math notranslate nohighlight">\(\mu_1=0.5\)</span>, so the null hypothesis is false. Therefore, we have made
a Type II error by failing to reject the null hypothesis when the null
hypothesis is false.</p>
<p>We now test <span class="math notranslate nohighlight">\(H_{0,j}: \mu_j=0\)</span> for <span class="math notranslate nohighlight">\(j=1,\ldots,100\)</span>. We compute the
100 <span class="math notranslate nohighlight">\(p\)</span>-values, and then construct a vector recording whether the
<span class="math notranslate nohighlight">\(j\)</span>th <span class="math notranslate nohighlight">\(p\)</span>-value is less than or equal to 0.05, in which case we reject
<span class="math notranslate nohighlight">\(H_{0j}\)</span>, or greater than 0.05, in which case we do not reject
<span class="math notranslate nohighlight">\(H_{0j}\)</span>, for <span class="math notranslate nohighlight">\(j=1,\ldots,100\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
   <span class="n">p_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
<span class="n">decision</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Reject H0&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Do not reject H0&#39;</span><span class="p">])</span>
<span class="n">truth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">true_mean</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
                       <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Since this is a simulated data set, we can create a <span class="math notranslate nohighlight">\(2 \times 2\)</span> table
similar to  Table 13.2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">decision</span><span class="p">,</span>
            <span class="n">truth</span><span class="p">,</span>
     <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Decision&#39;</span><span class="p">],</span>
     <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H0&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>H0</th>
      <th>True</th>
      <th>False</th>
    </tr>
    <tr>
      <th>Decision</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reject H0</th>
      <td>5</td>
      <td>15</td>
    </tr>
    <tr>
      <th>Do not reject H0</th>
      <td>45</td>
      <td>35</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Therefore, at level <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, we reject 15 of the 50 false
null hypotheses, and we incorrectly reject 5 of the true null
hypotheses. Using the notation from Section 13.3, we have
<span class="math notranslate nohighlight">\(V=5\)</span>, <span class="math notranslate nohighlight">\(S=15\)</span>, <span class="math notranslate nohighlight">\(U=45\)</span> and <span class="math notranslate nohighlight">\(W=35\)</span>.
We have set <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, which means that we expect to reject around
5% of the true null hypotheses. This is in line with the <span class="math notranslate nohighlight">\(2 \times 2\)</span>
table above, which indicates that we rejected <span class="math notranslate nohighlight">\(V=5\)</span> of the <span class="math notranslate nohighlight">\(50\)</span> true
null hypotheses.</p>
<p>In the simulation above, for the false null hypotheses, the ratio of
the mean to the standard deviation was only <span class="math notranslate nohighlight">\(0.5/1 = 0.5\)</span>. This
amounts to quite a weak signal, and it resulted in a high number of
Type II errors.  Let’s instead simulate data with a stronger signal,
so that the ratio of the mean to the standard deviation for the false
null hypotheses equals <span class="math notranslate nohighlight">\(1\)</span>. We make only 10 Type II errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">true_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">X</span> <span class="o">+=</span> <span class="n">true_mean</span><span class="p">[</span><span class="kc">None</span><span class="p">,:]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
   <span class="n">p_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
<span class="n">decision</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Reject H0&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;Do not reject H0&#39;</span><span class="p">])</span>
<span class="n">truth</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">true_mean</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
                       <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">decision</span><span class="p">,</span>
            <span class="n">truth</span><span class="p">,</span>
            <span class="n">rownames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Decision&#39;</span><span class="p">],</span>
            <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H0&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>H0</th>
      <th>True</th>
      <th>False</th>
    </tr>
    <tr>
      <th>Decision</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Reject H0</th>
      <td>2</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Do not reject H0</th>
      <td>48</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="family-wise-error-rate">
<h2>Family-Wise Error Rate<a class="headerlink" href="#family-wise-error-rate" title="Permalink to this heading">#</a></h2>
<p>Recall from  (13.5)  that if the null hypothesis is true
for each of <span class="math notranslate nohighlight">\(m\)</span> independent hypothesis tests, then the FWER is equal
to <span class="math notranslate nohighlight">\(1-(1-\alpha)^m\)</span>. We can use this expression to compute the FWER
for <span class="math notranslate nohighlight">\(m=1,\ldots, 500\)</span> and <span class="math notranslate nohighlight">\(\alpha=0.05\)</span>, <span class="math notranslate nohighlight">\(0.01\)</span>, and <span class="math notranslate nohighlight">\(0.001\)</span>.
We plot the FWER for these values of <span class="math notranslate nohighlight">\(\alpha\)</span> in order to
reproduce  Figure 13.2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="p">[</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m</span><span class="p">,</span>
         <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="n">m</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha=</span><span class="si">%s</span><span class="s1">$&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
         <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">]]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Hypotheses&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Family-Wise Error Rate&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e1afe06b3872a26f0ced2f86165cda393dbc8d4f802d834f369ef90ce505dc76.png" src="../../../_images/e1afe06b3872a26f0ced2f86165cda393dbc8d4f802d834f369ef90ce505dc76.png" />
</div>
</div>
<p>As discussed previously, even for moderate values of <span class="math notranslate nohighlight">\(m\)</span> such as <span class="math notranslate nohighlight">\(50\)</span>,
the FWER exceeds <span class="math notranslate nohighlight">\(0.05\)</span> unless <span class="math notranslate nohighlight">\(\alpha\)</span> is set to a very low value,
such as <span class="math notranslate nohighlight">\(0.001\)</span>.  Of course, the problem with setting <span class="math notranslate nohighlight">\(\alpha\)</span> to such
a low value is that we are likely to make a number of Type II errors:
in other words, our power is very low.</p>
<p>We now conduct a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test for each of the first five
managers in the<br />
<code class="docutils literal notranslate"><span class="pre">Fund</span></code>   dataset, in order to test the null
hypothesis that the <span class="math notranslate nohighlight">\(j\)</span>th fund manager’s mean return equals zero,
<span class="math notranslate nohighlight">\(H_{0,j}: \mu_j=0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fund</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;Fund&#39;</span><span class="p">)</span>
<span class="n">fund_mini</span> <span class="o">=</span> <span class="n">Fund</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span>
<span class="n">fund_mini_pvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">fund_mini_pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">fund_mini</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
<span class="n">fund_mini_pvals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00620236, 0.91827115, 0.01160098, 0.6005396 , 0.75578151])
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-values are low for Managers One and Three, and high for the
other three managers.  However, we cannot simply reject <span class="math notranslate nohighlight">\(H_{0,1}\)</span> and
<span class="math notranslate nohighlight">\(H_{0,3}\)</span>, since this would fail to account for the multiple testing
that we have performed. Instead, we will conduct Bonferroni’s method
and Holm’s method to control the FWER.</p>
<p>To do this, we use the <code class="docutils literal notranslate"><span class="pre">multipletests()</span></code>  function from the
<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> module (abbreviated to <code class="docutils literal notranslate"><span class="pre">mult_test()</span></code>). Given the <span class="math notranslate nohighlight">\(p\)</span>-values,
for methods like Holm and Bonferroni the function outputs
adjusted <span class="math notranslate nohighlight">\(p\)</span>-values,  which
can be thought of as a new set of <span class="math notranslate nohighlight">\(p\)</span>-values that have been corrected
for multiple testing. If the adjusted <span class="math notranslate nohighlight">\(p\)</span>-value for a given hypothesis
is less than or equal to <span class="math notranslate nohighlight">\(\alpha\)</span>, then that hypothesis can be
rejected while maintaining a FWER of no more than <span class="math notranslate nohighlight">\(\alpha\)</span>. In other
words, for such methods, the adjusted <span class="math notranslate nohighlight">\(p\)</span>-values resulting from the <code class="docutils literal notranslate"><span class="pre">multipletests()</span></code>
function can simply be compared to the desired FWER in order to
determine whether or not to reject each hypothesis. We will later
see that we can use the same function to control FDR as well.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mult_test()</span></code> function takes <span class="math notranslate nohighlight">\(p\)</span>-values and a <code class="docutils literal notranslate"><span class="pre">method</span></code> argument, as well as an optional
<code class="docutils literal notranslate"><span class="pre">alpha</span></code> argument. It returns the  decisions (<code class="docutils literal notranslate"><span class="pre">reject</span></code> below)
as well as the adjusted <span class="math notranslate nohighlight">\(p\)</span>-values (<code class="docutils literal notranslate"><span class="pre">bonf</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reject</span><span class="p">,</span> <span class="n">bonf</span> <span class="o">=</span> <span class="n">mult_test</span><span class="p">(</span><span class="n">fund_mini_pvals</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;bonferroni&quot;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">reject</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ True, False, False, False, False])
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(p\)</span>-values <code class="docutils literal notranslate"><span class="pre">bonf</span></code> are simply the <code class="docutils literal notranslate"><span class="pre">fund_mini_pvalues</span></code> multiplied by 5 and truncated to be less than
or equal to 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bonf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">fund_mini_pvals</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.03101178, 1.        , 0.05800491, 1.        , 1.        ]),
 array([0.03101178, 1.        , 0.05800491, 1.        , 1.        ]))
</pre></div>
</div>
</div>
</div>
<p>Therefore, using Bonferroni’s method, we are able to reject the null hypothesis only for Manager
One while controlling FWER at <span class="math notranslate nohighlight">\(0.05\)</span>.</p>
<p>By contrast, using Holm’s method, the adjusted <span class="math notranslate nohighlight">\(p\)</span>-values indicate
that we can  reject the null
hypotheses for Managers One and Three at a FWER of <span class="math notranslate nohighlight">\(0.05\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mult_test</span><span class="p">(</span><span class="n">fund_mini_pvals</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;holm&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ True, False,  True, False, False]),
 array([0.03101178, 1.        , 0.04640393, 1.        , 1.        ]))
</pre></div>
</div>
</div>
</div>
<p>As discussed previously, Manager One seems to perform particularly
well, whereas Manager Two has poor performance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fund_mini</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Manager1    3.0
Manager2   -0.1
Manager3    2.8
Manager4    0.5
Manager5    0.3
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Is there evidence of a meaningful difference in performance between
these two managers?  We can check this by performing a  paired <span class="math notranslate nohighlight">\(t\)</span>-test  using the <code class="docutils literal notranslate"><span class="pre">ttest_rel()</span></code> function
from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">fund_mini</span><span class="p">[</span><span class="s1">&#39;Manager1&#39;</span><span class="p">],</span>
          <span class="n">fund_mini</span><span class="p">[</span><span class="s1">&#39;Manager2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.038391072368079586
</pre></div>
</div>
</div>
</div>
<p>The test results in a <span class="math notranslate nohighlight">\(p\)</span>-value of 0.038,
suggesting a statistically significant difference.</p>
<p>However, we decided to perform this test only after examining the data
and noting that Managers One and Two had the highest and lowest mean
performances.  In a sense, this means that we have implicitly
performed <span class="math notranslate nohighlight">\({5 \choose 2} = 5(5-1)/2=10\)</span> hypothesis tests, rather than
just one, as discussed in  Section 13.3.2.  Hence, we use the
<code class="docutils literal notranslate"><span class="pre">pairwise_tukeyhsd()</span></code>  function from
<code class="docutils literal notranslate"><span class="pre">statsmodels.stats.multicomp</span></code> to apply Tukey’s method
in order to adjust for multiple testing.  This function takes
as input a fitted <em>ANOVA</em>  regression model, which is
essentially just a linear regression in which all of the predictors
are qualitative.  In this case, the response consists of the monthly
excess returns achieved by each manager, and the predictor indicates
the manager to which each return corresponds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">returns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">fund_mini</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">managers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">tukey</span> <span class="o">=</span> <span class="n">pairwise_tukeyhsd</span><span class="p">(</span><span class="n">returns</span><span class="p">,</span> <span class="n">managers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tukey</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiple Comparison of Means - Tukey HSD, FWER=0.05
===================================================
group1 group2 meandiff p-adj   lower  upper  reject
---------------------------------------------------
     1      2     -3.1 0.1862 -6.9865 0.7865  False
     1      3     -0.2 0.9999 -4.0865 3.6865  False
     1      4     -2.5 0.3948 -6.3865 1.3865  False
     1      5     -2.7 0.3152 -6.5865 1.1865  False
     2      3      2.9 0.2453 -0.9865 6.7865  False
     2      4      0.6 0.9932 -3.2865 4.4865  False
     2      5      0.4 0.9986 -3.4865 4.2865  False
     3      4     -2.3  0.482 -6.1865 1.5865  False
     3      5     -2.5 0.3948 -6.3865 1.3865  False
     4      5     -0.2 0.9999 -4.0865 3.6865  False
---------------------------------------------------
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pairwise_tukeyhsd()</span></code> function provides confidence intervals
for the difference between each pair of managers (<code class="docutils literal notranslate"><span class="pre">lower</span></code> and
<code class="docutils literal notranslate"><span class="pre">upper</span></code>), as well as a <span class="math notranslate nohighlight">\(p\)</span>-value. All of these quantities have
been adjusted for multiple testing. Notice that the <span class="math notranslate nohighlight">\(p\)</span>-value for the
difference between Managers One and Two has increased from <span class="math notranslate nohighlight">\(0.038\)</span> to
<span class="math notranslate nohighlight">\(0.186\)</span>, so there is no longer clear evidence of a difference between
the managers’ performances.  We can plot the confidence intervals for
the pairwise comparisons using the <code class="docutils literal notranslate"><span class="pre">plot_simultaneous()</span></code> method
of <code class="docutils literal notranslate"><span class="pre">tukey</span></code>. Any pair of intervals that don’t overlap indicates a significant difference at the nominal level of 0.05. In this case,
no differences are considered significant as reported in the table above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">tukey</span><span class="o">.</span><span class="n">plot_simultaneous</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f0086ac83d09f18fb32a8a2e338c94e2c16277c55f88b2a57c5d7416d94e8838.png" src="../../../_images/f0086ac83d09f18fb32a8a2e338c94e2c16277c55f88b2a57c5d7416d94e8838.png" />
</div>
</div>
</section>
<section id="false-discovery-rate">
<h2>False Discovery Rate<a class="headerlink" href="#false-discovery-rate" title="Permalink to this heading">#</a></h2>
<p>Now we perform hypothesis tests for all 2,000 fund managers in the
<code class="docutils literal notranslate"><span class="pre">Fund</span></code>  dataset. We perform a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test
of   <span class="math notranslate nohighlight">\(H_{0,j}: \mu_j=0\)</span>, which states that the
<span class="math notranslate nohighlight">\(j\)</span>th fund manager’s mean return is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fund_pvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">manager</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Fund</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">fund_pvalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">Fund</span><span class="p">[</span><span class="n">manager</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
</div>
<p>There are far too many managers to consider trying to control the FWER.
Instead, we focus on controlling the FDR: that is, the expected fraction of rejected null hypotheses that are actually false positives.
The <code class="docutils literal notranslate"><span class="pre">multipletests()</span></code> function (abbreviated <code class="docutils literal notranslate"><span class="pre">mult_test()</span></code>) can be used to carry out the Benjamini–Hochberg procedure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fund_qvalues</span> <span class="o">=</span> <span class="n">mult_test</span><span class="p">(</span><span class="n">fund_pvalues</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;fdr_bh&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">fund_qvalues</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.08988921, 0.991491  , 0.12211561, 0.92342997, 0.95603587,
       0.07513802, 0.0767015 , 0.07513802, 0.07513802, 0.07513802])
</pre></div>
</div>
</div>
</div>
<p>The  <em>q-values</em> output by the
Benjamini–Hochberg procedure can be interpreted as the smallest FDR
threshold at which we would reject a particular null hypothesis. For
instance, a <span class="math notranslate nohighlight">\(q\)</span>-value of <span class="math notranslate nohighlight">\(0.1\)</span> indicates that we can reject the
corresponding null hypothesis at an FDR of 10% or greater, but that
we cannot reject the null hypothesis at an FDR below 10%.</p>
<p>If we control the FDR at 10%, then for how many of the fund managers can we reject <span class="math notranslate nohighlight">\(H_{0,j}: \mu_j=0\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">fund_qvalues</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>146
</pre></div>
</div>
</div>
</div>
<p>We find that 146 of the 2,000 fund managers have a <span class="math notranslate nohighlight">\(q\)</span>-value below
0.1; therefore, we are able to conclude that 146 of the fund managers
beat the market at an FDR of 10%.  Only about 15 (10% of 146) of
these fund managers are likely to be false discoveries.</p>
<p>By contrast, if we had instead used Bonferroni’s method to control the
FWER at level <span class="math notranslate nohighlight">\(\alpha=0.1\)</span>, then we would have failed to reject any
null hypotheses!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">fund_pvalues</span> <span class="o">&lt;=</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Figure 13.6 displays the ordered
<span class="math notranslate nohighlight">\(p\)</span>-values, <span class="math notranslate nohighlight">\(p_{(1)} \leq p_{(2)} \leq \cdots \leq p_{(2000)}\)</span>, for
the  <code class="docutils literal notranslate"><span class="pre">Fund</span></code>  dataset, as well as the threshold for rejection by the
Benjamini–Hochberg procedure.  Recall that the Benjamini–Hochberg
procedure identifies the largest <span class="math notranslate nohighlight">\(p\)</span>-value such that <span class="math notranslate nohighlight">\(p_{(j)}&lt;qj/m\)</span>,
and rejects all hypotheses for which the <span class="math notranslate nohighlight">\(p\)</span>-value is less than or
equal to <span class="math notranslate nohighlight">\(p_{(j)}\)</span>. In the code below, we implement the
Benjamini–Hochberg procedure ourselves, in order to illustrate how it
works. We first order the <span class="math notranslate nohighlight">\(p\)</span>-values. We then identify all <span class="math notranslate nohighlight">\(p\)</span>-values
that satisfy <span class="math notranslate nohighlight">\(p_{(j)}&lt;qj/m\)</span> (<code class="docutils literal notranslate"><span class="pre">sorted_set_</span></code>).  Finally, <code class="docutils literal notranslate"><span class="pre">selected_</span></code>
is a boolean array indicating which <span class="math notranslate nohighlight">\(p\)</span>-values
are less than or equal to the largest
<span class="math notranslate nohighlight">\(p\)</span>-value in <code class="docutils literal notranslate"><span class="pre">sorted_[sorted_set_]</span></code>. Therefore, <code class="docutils literal notranslate"><span class="pre">selected_</span></code> indexes the
<span class="math notranslate nohighlight">\(p\)</span>-values rejected by the Benjamini–Hochberg procedure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sorted_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">fund_pvalues</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">fund_pvalues</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">q</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">sorted_set_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sorted_</span> <span class="o">&lt;</span> <span class="n">q</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">sorted_set_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">selected_</span> <span class="o">=</span> <span class="n">fund_pvalues</span> <span class="o">&lt;</span> <span class="n">sorted_</span><span class="p">[</span><span class="n">sorted_set_</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">sorted_set_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">sorted_set_</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">selected_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sorted_set_</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p>We now reproduce  the middle panel of Figure 13.6.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sorted_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
           <span class="n">sorted_</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;P-Value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sorted_set_</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">sorted_</span><span class="p">[</span><span class="n">sorted_set_</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axline</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="o">/</span><span class="n">m</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/66300e00893b8d1680891267288b421c625df578a61e36de880afea48a95b376.png" src="../../../_images/66300e00893b8d1680891267288b421c625df578a61e36de880afea48a95b376.png" />
</div>
</div>
</section>
<section id="a-re-sampling-approach">
<h2>A Re-Sampling Approach<a class="headerlink" href="#a-re-sampling-approach" title="Permalink to this heading">#</a></h2>
<p>Here, we implement the re-sampling approach to hypothesis testing
using the  <code class="docutils literal notranslate"><span class="pre">Khan</span></code>  dataset, which we investigated in
Section 13.5.  First, we merge the training and
testing data, which results in observations on 83 patients for
2,308 genes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Khan</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;Khan&#39;</span><span class="p">)</span>      
<span class="n">D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Khan</span><span class="p">[</span><span class="s1">&#39;xtrain&#39;</span><span class="p">],</span> <span class="n">Khan</span><span class="p">[</span><span class="s1">&#39;xtest&#39;</span><span class="p">]])</span>
<span class="n">D</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Khan</span><span class="p">[</span><span class="s1">&#39;ytrain&#39;</span><span class="p">],</span> <span class="n">Khan</span><span class="p">[</span><span class="s1">&#39;ytest&#39;</span><span class="p">]])</span>
<span class="n">D</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y
2    29
4    25
3    18
1    11
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>There are four classes of cancer. For each gene, we compare the mean
expression in the second class (rhabdomyosarcoma) to the mean
expression in the fourth class (Burkitt’s lymphoma).  Performing a
standard two-sample <span class="math notranslate nohighlight">\(t\)</span>-test<br />
using <code class="docutils literal notranslate"><span class="pre">ttest_ind()</span></code>  from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> on the <span class="math notranslate nohighlight">\(11\)</span>th
gene produces a test-statistic of -2.09 and an associated <span class="math notranslate nohighlight">\(p\)</span>-value
of 0.0412, suggesting modest evidence of a difference in mean
expression levels between the two cancer types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D2</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">D4</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">gene_11</span> <span class="o">=</span> <span class="s1">&#39;G0011&#39;</span>
<span class="n">observedT</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">D2</span><span class="p">[</span><span class="n">gene_11</span><span class="p">],</span>
                              <span class="n">D4</span><span class="p">[</span><span class="n">gene_11</span><span class="p">],</span>
                              <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">observedT</span><span class="p">,</span> <span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-2.0936330736768185, 0.04118643782678394)
</pre></div>
</div>
</div>
</div>
<p>However, this <span class="math notranslate nohighlight">\(p\)</span>-value relies on the assumption that under the null
hypothesis of no difference between the two groups, the test statistic
follows a <span class="math notranslate nohighlight">\(t\)</span>-distribution with <span class="math notranslate nohighlight">\(29+25-2=52\)</span> degrees of freedom.
Instead of using this theoretical null distribution, we can randomly
split the 54 patients into two groups of 29 and 25, and compute a new
test statistic.  Under the null hypothesis of no difference between
the groups, this new test statistic should have the same distribution
as our original one.  Repeating this process 10,000 times allows us to
approximate the null distribution of the test statistic.  We compute
the fraction of the time that our observed test statistic exceeds the
test statistics obtained via re-sampling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">Tnull</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="n">D_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">D2</span><span class="p">[</span><span class="n">gene_11</span><span class="p">],</span> <span class="n">D4</span><span class="p">[</span><span class="n">gene_11</span><span class="p">]])</span>
<span class="n">n_</span> <span class="o">=</span> <span class="n">D2</span><span class="p">[</span><span class="n">gene_11</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">D_null</span> <span class="o">=</span> <span class="n">D_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
    <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">D_null</span><span class="p">)</span>
    <span class="n">ttest_</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">D_null</span><span class="p">[:</span><span class="n">n_</span><span class="p">],</span>
                       <span class="n">D_null</span><span class="p">[</span><span class="n">n_</span><span class="p">:],</span>
                       <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">Tnull</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_</span><span class="o">.</span><span class="n">statistic</span>
<span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Tnull</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observedT</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0398
</pre></div>
</div>
</div>
</div>
<p>This fraction, 0.0398,
is our re-sampling-based <span class="math notranslate nohighlight">\(p\)</span>-value.
It is almost identical to the <span class="math notranslate nohighlight">\(p\)</span>-value of  0.0412 obtained using the theoretical null distribution.
We can plot  a histogram of the re-sampling-based test statistics in order to reproduce  Figure 13.7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">Tnull</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Null&#39;</span><span class="p">)</span>
<span class="n">xval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.2</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span>
        <span class="n">t_dbn</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span> <span class="n">D_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">observedT</span><span class="p">,</span>
           <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Null Distribution of Test Statistic&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b75c203277439797bd103cf6b26aef8b23bd5528b004bdd10581dc2434e07e59.png" src="../../../_images/b75c203277439797bd103cf6b26aef8b23bd5528b004bdd10581dc2434e07e59.png" />
</div>
</div>
<p>The re-sampling-based null distribution is almost identical to the theoretical null distribution, which is displayed in red.</p>
<p>Finally, we implement the plug-in re-sampling FDR approach outlined in
Algorithm 13.4. Depending on the speed of your
computer, calculating the FDR for all 2,308 genes in the <code class="docutils literal notranslate"><span class="pre">Khan</span></code>
dataset may take a while.  Hence, we will illustrate the approach on a
random subset of 100 genes.  For each gene, we first compute the
observed test statistic, and then produce 10,000 re-sampled test
statistics. This may take a few minutes to run.  If you are in a rush,
then you could set <code class="docutils literal notranslate"><span class="pre">B</span></code> equal to a smaller value (e.g. <code class="docutils literal notranslate"><span class="pre">B=500</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">Khan</span><span class="p">[</span><span class="s1">&#39;xtest&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">T_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">Tnull_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="n">T_vals</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">D2</span><span class="p">[</span><span class="n">col</span><span class="p">],</span>
                          <span class="n">D4</span><span class="p">[</span><span class="n">col</span><span class="p">],</span>
                          <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span>
    <span class="n">D_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">D2</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">D4</span><span class="p">[</span><span class="n">col</span><span class="p">]])</span>
    <span class="n">D_null</span> <span class="o">=</span> <span class="n">D_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">D_null</span><span class="p">)</span>
        <span class="n">ttest_</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">D_null</span><span class="p">[:</span><span class="n">n_</span><span class="p">],</span>
                           <span class="n">D_null</span><span class="p">[</span><span class="n">n_</span><span class="p">:],</span>
                           <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Tnull_vals</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_</span><span class="o">.</span><span class="n">statistic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="n">line</span> <span class="mi">15</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">D_null</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">15</span>     <span class="n">ttest_</span> <span class="o">=</span> <span class="n">ttest_ind</span><span class="p">(</span><span class="n">D_null</span><span class="p">[:</span><span class="n">n_</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>                        <span class="n">D_null</span><span class="p">[</span><span class="n">n_</span><span class="p">:],</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span>                        <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span>     <span class="n">Tnull_vals</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">b</span><span class="p">]</span> <span class="o">=</span> <span class="n">ttest_</span><span class="o">.</span><span class="n">statistic</span>

<span class="nn">File ~/work/isl/isl/.venv/lib/python3.10/site-packages/scipy/stats/_axis_nan_policy.py:523,</span> in <span class="ni">_axis_nan_policy_factory.&lt;locals&gt;.axis_nan_policy_decorator.&lt;locals&gt;.axis_nan_policy_wrapper</span><span class="nt">(***failed resolving arguments***)</span>
<span class="g g-Whitespace">    </span><span class="mi">521</span> <span class="k">if</span> <span class="n">sentinel</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">522</span>     <span class="n">samples</span> <span class="o">=</span> <span class="n">_remove_sentinel</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">paired</span><span class="p">,</span> <span class="n">sentinel</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">523</span> <span class="n">res</span> <span class="o">=</span> <span class="n">hypotest_fun_out</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">524</span> <span class="n">res</span> <span class="o">=</span> <span class="n">result_to_tuple</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">525</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_add_reduced_axes</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">reduced_axes</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span>

<span class="nn">File ~/work/isl/isl/.venv/lib/python3.10/site-packages/scipy/stats/_stats_py.py:7457,</span> in <span class="ni">ttest_ind</span><span class="nt">(a, b, axis, equal_var, nan_policy, permutations, random_state, alternative, trim)</span>
<span class="g g-Whitespace">   </span><span class="mi">7455</span>     <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7456</span> <span class="n">v1</span> <span class="o">=</span> <span class="n">_var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">7457</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">_var</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7458</span> <span class="k">if</span> <span class="n">equal_var</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7459</span>     <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">old_errstate</span><span class="p">)</span>

<span class="nn">File ~/work/isl/isl/.venv/lib/python3.10/site-packages/scipy/stats/_stats_py.py:1100,</span> in <span class="ni">_var</span><span class="nt">(x, axis, ddof, mean)</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span> <span class="k">def</span> <span class="nf">_var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1099</span>     <span class="c1"># Calculate variance of sample, warning if precision is lost</span>
<span class="ne">-&gt; </span><span class="mi">1100</span>     <span class="n">var</span> <span class="o">=</span> <span class="n">_moment</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>     <span class="k">if</span> <span class="n">ddof</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1102</span>         <span class="n">n</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

<span class="nn">File ~/work/isl/isl/.venv/lib/python3.10/site-packages/scipy/stats/_stats_py.py:1095,</span> in <span class="ni">_moment</span><span class="nt">(a, moment, axis, mean)</span>
<span class="g g-Whitespace">   </span><span class="mi">1093</span>     <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1094</span>         <span class="n">s</span> <span class="o">*=</span> <span class="n">a_zero_mean</span>
<span class="ne">-&gt; </span><span class="mi">1095</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>

<span class="nn">File ~/work/isl/isl/.venv/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504,</span> in <span class="ni">mean</span><span class="nt">(a, axis, dtype, out, keepdims, where)</span>
<span class="g g-Whitespace">   </span><span class="mi">3501</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3502</span>         <span class="k">return</span> <span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3504</span> <span class="k">return</span> <span class="n">_methods</span><span class="o">.</span><span class="n">_mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3505</span>                       <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/work/isl/isl/.venv/lib/python3.10/site-packages/numpy/core/_methods.py:118,</span> in <span class="ni">_mean</span><span class="nt">(a, axis, dtype, out, keepdims, where)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>         <span class="n">dtype</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>         <span class="n">is_float16_result</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">118</span> <span class="n">ret</span> <span class="o">=</span> <span class="n">umr_sum</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">mu</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>     <span class="k">with</span> <span class="n">_no_nep50_warning</span><span class="p">():</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<p>Next, we compute the number of rejected null hypotheses <span class="math notranslate nohighlight">\(R\)</span>, the
estimated number of false positives <span class="math notranslate nohighlight">\(\widehat{V}\)</span>, and the estimated
FDR, for a range of threshold values <span class="math notranslate nohighlight">\(c\)</span> in
Algorithm 13.4. The threshold values are chosen
using the absolute values of the test statistics from the 100 genes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutoffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_vals</span><span class="p">))</span>
<span class="n">FDRs</span><span class="p">,</span> <span class="n">Rs</span><span class="p">,</span> <span class="n">Vs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
   <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_vals</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
   <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Tnull_vals</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">B</span>
   <span class="n">Rs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span>
   <span class="n">Vs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span>
   <span class="n">FDRs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span> <span class="o">/</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<p>Now, for any given FDR, we can find the genes that will be
rejected. For example, with FDR controlled at 0.1, we reject 15 of the
100 null hypotheses. On average, we would expect about one or two of
these genes (i.e. 10% of 15) to be false discoveries.  At an FDR of
0.2, we can reject the null hypothesis for 28 genes, of which we
expect around six to be false discoveries.</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">idx</span></code> stores which
genes were included in our 100 randomly-selected genes. Let’s look at
the genes whose estimated FDR is less than 0.1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_vals</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="n">FDRs</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
<p>At an FDR threshold of 0.2, more genes are selected, at the cost of having a higher expected
proportion of false discoveries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">T_vals</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">cutoffs</span><span class="p">[</span><span class="n">FDRs</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
<p>The next line  generates  Figure 13.11, which is similar
to  Figure 13.9,
except that it is based on only  a subset of the genes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rs</span><span class="p">,</span> <span class="n">FDRs</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Rejections&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;False Discovery Rate&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/chapters/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Ch12-unsup-lab.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 12</p>
      </div>
    </a>
    <a class="right-next"
       href="Ch2-statlearn-lab.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Chapter 13</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-multiple-testing">Lab: Multiple Testing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-hypothesis-tests">Review of Hypothesis Tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#family-wise-error-rate">Family-Wise Error Rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#false-discovery-rate">False Discovery Rate</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-re-sampling-approach">A Re-Sampling Approach</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Trevor Hastie et al.
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>